<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>vue实战总结 | Jian‘s blog</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/jian_x48.png">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/jian_x192.png">
    <meta name="description" content="每天进步一点点">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/jian_x192.png">
    <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/assets/css/0.styles.19232fe9.css" as="style"><link rel="preload" href="/assets/js/app.9e441e61.js" as="script"><link rel="preload" href="/assets/js/2.36bde0fd.js" as="script"><link rel="preload" href="/assets/js/76.451d3bf2.js" as="script"><link rel="preload" href="/assets/js/3.5a07e503.js" as="script"><link rel="prefetch" href="/assets/js/10.bc82d67b.js"><link rel="prefetch" href="/assets/js/11.ead9b8ca.js"><link rel="prefetch" href="/assets/js/12.a048ccaa.js"><link rel="prefetch" href="/assets/js/13.3e4cc077.js"><link rel="prefetch" href="/assets/js/14.58cd0fa5.js"><link rel="prefetch" href="/assets/js/15.98e26beb.js"><link rel="prefetch" href="/assets/js/16.4cf1daea.js"><link rel="prefetch" href="/assets/js/17.c190a7fe.js"><link rel="prefetch" href="/assets/js/18.89814285.js"><link rel="prefetch" href="/assets/js/19.77f58842.js"><link rel="prefetch" href="/assets/js/20.9920ac2c.js"><link rel="prefetch" href="/assets/js/21.6a8c9cfe.js"><link rel="prefetch" href="/assets/js/22.cfd89a61.js"><link rel="prefetch" href="/assets/js/23.48f5d9f7.js"><link rel="prefetch" href="/assets/js/24.a8c5ac10.js"><link rel="prefetch" href="/assets/js/25.842b3853.js"><link rel="prefetch" href="/assets/js/26.9c5fe1dd.js"><link rel="prefetch" href="/assets/js/27.c4f0a52b.js"><link rel="prefetch" href="/assets/js/28.ce11023f.js"><link rel="prefetch" href="/assets/js/29.9001ac2f.js"><link rel="prefetch" href="/assets/js/30.5edf0dc1.js"><link rel="prefetch" href="/assets/js/31.57d2aeed.js"><link rel="prefetch" href="/assets/js/32.db6f674e.js"><link rel="prefetch" href="/assets/js/33.038cad31.js"><link rel="prefetch" href="/assets/js/34.bff4a907.js"><link rel="prefetch" href="/assets/js/35.e9272942.js"><link rel="prefetch" href="/assets/js/36.896895d7.js"><link rel="prefetch" href="/assets/js/37.91a5bb8c.js"><link rel="prefetch" href="/assets/js/38.3f6a6f29.js"><link rel="prefetch" href="/assets/js/39.270d8c27.js"><link rel="prefetch" href="/assets/js/4.0800d99b.js"><link rel="prefetch" href="/assets/js/40.b379e318.js"><link rel="prefetch" href="/assets/js/41.f3073d82.js"><link rel="prefetch" href="/assets/js/42.867935ca.js"><link rel="prefetch" href="/assets/js/43.30335621.js"><link rel="prefetch" href="/assets/js/44.993aea4e.js"><link rel="prefetch" href="/assets/js/45.60eb5226.js"><link rel="prefetch" href="/assets/js/46.8501be1f.js"><link rel="prefetch" href="/assets/js/47.ba2302fc.js"><link rel="prefetch" href="/assets/js/48.e932482f.js"><link rel="prefetch" href="/assets/js/49.c1af1af4.js"><link rel="prefetch" href="/assets/js/5.1d8a5d7f.js"><link rel="prefetch" href="/assets/js/50.e7715e10.js"><link rel="prefetch" href="/assets/js/51.ab6021ba.js"><link rel="prefetch" href="/assets/js/52.c5c5c3ef.js"><link rel="prefetch" href="/assets/js/53.7157cd05.js"><link rel="prefetch" href="/assets/js/54.f4abd89d.js"><link rel="prefetch" href="/assets/js/55.c86bbebc.js"><link rel="prefetch" href="/assets/js/56.ee48a85c.js"><link rel="prefetch" href="/assets/js/57.90d4c487.js"><link rel="prefetch" href="/assets/js/58.1d4866f8.js"><link rel="prefetch" href="/assets/js/59.75c6bc90.js"><link rel="prefetch" href="/assets/js/6.90059570.js"><link rel="prefetch" href="/assets/js/60.c5e61798.js"><link rel="prefetch" href="/assets/js/61.54457b0e.js"><link rel="prefetch" href="/assets/js/62.2e0af734.js"><link rel="prefetch" href="/assets/js/63.07cece40.js"><link rel="prefetch" href="/assets/js/64.e6ab0174.js"><link rel="prefetch" href="/assets/js/65.663550a9.js"><link rel="prefetch" href="/assets/js/66.64ad9de7.js"><link rel="prefetch" href="/assets/js/67.cc5c5ab3.js"><link rel="prefetch" href="/assets/js/68.d76b1a45.js"><link rel="prefetch" href="/assets/js/69.06c85095.js"><link rel="prefetch" href="/assets/js/7.e0481b37.js"><link rel="prefetch" href="/assets/js/70.5fa17108.js"><link rel="prefetch" href="/assets/js/71.ea8df0ea.js"><link rel="prefetch" href="/assets/js/72.12d99daf.js"><link rel="prefetch" href="/assets/js/73.8b6c81cd.js"><link rel="prefetch" href="/assets/js/74.e089a7e8.js"><link rel="prefetch" href="/assets/js/75.eda86622.js"><link rel="prefetch" href="/assets/js/77.5a71a520.js"><link rel="prefetch" href="/assets/js/78.5e4673c6.js"><link rel="prefetch" href="/assets/js/79.f657e29d.js"><link rel="prefetch" href="/assets/js/8.e1e88656.js"><link rel="prefetch" href="/assets/js/80.d7b2d65d.js"><link rel="prefetch" href="/assets/js/81.c9dc1609.js"><link rel="prefetch" href="/assets/js/82.2b309c6c.js"><link rel="prefetch" href="/assets/js/9.54f76d53.js">
    <link rel="stylesheet" href="/assets/css/0.styles.19232fe9.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/jian.jpeg" alt="Jian‘s blog" class="logo"> <span class="site-name can-hide">Jian‘s blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="js" class="dropdown-title"><span class="title">js</span> <span class="arrow down"></span></button> <button type="button" aria-label="js" class="mobile-dropdown-title"><span class="title">js</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frontend/js/" class="nav-link">
  js杂记
</a></li><li class="dropdown-item"><!----> <a href="/frontend/js/promise.html" class="nav-link">
  Promise规范和应用
</a></li><li class="dropdown-item"><!----> <a href="/frontend/js/browser.html" class="nav-link">
  浏览器对象详解
</a></li><li class="dropdown-item"><!----> <a href="/frontend/js/js_oop.html" class="nav-link">
  面向对象编程
</a></li><li class="dropdown-item"><!----> <a href="/frontend/js/ES6.html" class="nav-link">
  ES6ESNext规范详解
</a></li><li class="dropdown-item"><!----> <a href="/frontend/js/this_chain.html" class="nav-link">
  this指针作用域
</a></li><li class="dropdown-item"><!----> <a href="/frontend/js/typescript.html" class="nav-link">
  ts初探
</a></li><li class="dropdown-item"><!----> <a href="/frontend/ts/basics.html" class="nav-link">
  ts基础
</a></li><li class="dropdown-item"><!----> <a href="/frontend/ts/project.html" class="nav-link">
  ts工程
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工程化" class="dropdown-title"><span class="title">工程化</span> <span class="arrow down"></span></button> <button type="button" aria-label="工程化" class="mobile-dropdown-title"><span class="title">工程化</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frontend/tools/js_module.html" class="nav-link">
  模块化规范
</a></li><li class="dropdown-item"><!----> <a href="/frontend/tools/js_project.html" class="nav-link">
  前端工程化
</a></li><li class="dropdown-item"><!----> <a href="/frontend/tools/webpack.html" class="nav-link">
  webpack
</a></li><li class="dropdown-item"><!----> <a href="/frontend/tools/babel.html" class="nav-link">
  babel
</a></li><li class="dropdown-item"><!----> <a href="/frontend/tools/autotest.html" class="nav-link">
  自动化测试和部署
</a></li><li class="dropdown-item"><!----> <a href="/frontend/tools/ast.html" class="nav-link">
  AST
</a></li><li class="dropdown-item"><!----> <a href="/frontend/tools/solution.html" class="nav-link">
  前端方案
</a></li><li class="dropdown-item"><!----> <a href="/frontend/tools/js_tools.html" class="nav-link">
  常用工具
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="vue" class="dropdown-title"><span class="title">vue</span> <span class="arrow down"></span></button> <button type="button" aria-label="vue" class="mobile-dropdown-title"><span class="title">vue</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frontend/vue/index.html" class="nav-link">
  vue2.0基础
</a></li><li class="dropdown-item"><!----> <a href="/frontend/vue/advance.html" class="nav-link">
  vue2.0进阶
</a></li><li class="dropdown-item"><!----> <a href="/frontend/vue/vue-cli.html" class="nav-link">
  vue-cli
</a></li><li class="dropdown-item"><!----> <a href="/frontend/vue/vue-loader.html" class="nav-link">
  vue-loader
</a></li><li class="dropdown-item"><!----> <a href="/frontend/vue/vue-router.html" class="nav-link">
  vue-router
</a></li><li class="dropdown-item"><!----> <a href="/frontend/vue/vuex.html" class="nav-link">
  vuex
</a></li><li class="dropdown-item"><!----> <a href="/frontend/vue/vue_ssr.html" class="nav-link">
  vue-ssr
</a></li><li class="dropdown-item"><!----> <a href="/frontend/vue/vue-i18n.html" class="nav-link">
  vue-i18n
</a></li><li class="dropdown-item"><!----> <a href="/frontend/vue/vue-life.html" class="nav-link">
  生命周期
</a></li><li class="dropdown-item"><!----> <a href="/frontend/vue/vue_reactive.html" class="nav-link">
  响应式原理
</a></li><li class="dropdown-item"><!----> <a href="/frontend/vue/vue_diff.html" class="nav-link">
  diff原理
</a></li><li class="dropdown-item"><!----> <a href="/frontend/vue/vue-compiler.html" class="nav-link">
  编译原理
</a></li><li class="dropdown-item"><!----> <a href="/frontend/vue/vue-refs.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  实战总结
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="react" class="dropdown-title"><span class="title">react</span> <span class="arrow down"></span></button> <button type="button" aria-label="react" class="mobile-dropdown-title"><span class="title">react</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frontend/react/react.html" class="nav-link">
  react基础
</a></li><li class="dropdown-item"><!----> <a href="/frontend/react/react-advance.html" class="nav-link">
  react进阶
</a></li><li class="dropdown-item"><!----> <a href="/frontend/react/react-router.html" class="nav-link">
  react-router
</a></li><li class="dropdown-item"><!----> <a href="/frontend/react/react-state.html" class="nav-link">
  react状态管理
</a></li><li class="dropdown-item"><!----> <a href="/frontend/react/react-ssr.html" class="nav-link">
  react同构
</a></li><li class="dropdown-item"><!----> <a href="/frontend/react/react-component.html" class="nav-link">
  react组件封装
</a></li><li class="dropdown-item"><!----> <a href="/frontend/react/react-code.html" class="nav-link">
  react源码分析
</a></li><li class="dropdown-item"><!----> <a href="/frontend/ts/react-ts.html" class="nav-link">
  react-ts实战
</a></li><li class="dropdown-item"><!----> <a href="/frontend/react/react-practice.html" class="nav-link">
  react问题整理
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="nodejs" class="dropdown-title"><span class="title">nodejs</span> <span class="arrow down"></span></button> <button type="button" aria-label="nodejs" class="mobile-dropdown-title"><span class="title">nodejs</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frontend/nodejs/index.html" class="nav-link">
  nodejs基础
</a></li><li class="dropdown-item"><!----> <a href="/frontend/nodejs/module.html" class="nav-link">
  nodejs常用框架
</a></li><li class="dropdown-item"><!----> <a href="/frontend/nodejs/http.html" class="nav-link">
  nodejs网络及部署
</a></li><li class="dropdown-item"><!----> <a href="/frontend/ts/express-ts.html" class="nav-link">
  express-ts实战
</a></li><li class="dropdown-item"><!----> <a href="/frontend/nodejs/info.html" class="nav-link">
  nodejs前研
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他" class="dropdown-title"><span class="title">其他</span> <span class="arrow down"></span></button> <button type="button" aria-label="其他" class="mobile-dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frontend/interview/" class="nav-link">
  前端面试
</a></li><li class="dropdown-item"><!----> <a href="/frontend/performance/performance.html" class="nav-link">
  前端性能优化
</a></li><li class="dropdown-item"><!----> <a href="/frontend/performance/explorer.html" class="nav-link">
  浏览器进程和线程
</a></li><li class="dropdown-item"><!----> <a href="/frontend/else/security-control.html" class="nav-link">
  前端网络安全
</a></li><li class="dropdown-item"><!----> <a href="/frontend/lowcode/lowcode.html" class="nav-link">
  低代码平台
</a></li><li class="dropdown-item"><!----> <a href="/frontend/else/micro-frontend.html" class="nav-link">
  微前端
</a></li><li class="dropdown-item"><!----> <a href="/frontend/else/designMode.html" class="nav-link">
  前端设计模式
</a></li><li class="dropdown-item"><!----> <a href="/frontend/css/" class="nav-link">
  css
</a></li><li class="dropdown-item"><!----> <a href="/frontend/mini-program/" class="nav-link">
  小程序
</a></li><li class="dropdown-item"><!----> <a href="/frontend/hybrid/hybrid.html" class="nav-link">
  hybrid开发及原理分析
</a></li><li class="dropdown-item"><!----> <a href="/frontend/else/canvas.html" class="nav-link">
  canvas
</a></li><li class="dropdown-item"><!----> <a href="/frontend/else/graph.html" class="nav-link">
  图片格式
</a></li><li class="dropdown-item"><!----> <a href="/frontend/else/web3.html" class="nav-link">
  web3探索
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="算法" class="dropdown-title"><span class="title">算法</span> <span class="arrow down"></span></button> <button type="button" aria-label="算法" class="mobile-dropdown-title"><span class="title">算法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frontend/algorithm/graph.html" class="nav-link">
  图的存储和遍历
</a></li><li class="dropdown-item"><!----> <a href="/frontend/algorithm/dpointer.html" class="nav-link">
  双指针
</a></li><li class="dropdown-item"><!----> <a href="/frontend/algorithm/Levenshtein.html" class="nav-link">
  最短编辑距离
</a></li><li class="dropdown-item"><!----> <a href="/frontend/algorithm/greed.html" class="nav-link">
  贪心算法
</a></li><li class="dropdown-item"><!----> <a href="/frontend/algorithm/dp.html" class="nav-link">
  动态规划
</a></li><li class="dropdown-item"><!----> <a href="/frontend/algorithm/leetcode.html" class="nav-link">
  leetcode
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><span class="title">后端</span> <span class="arrow down"></span></button> <button type="button" aria-label="后端" class="mobile-dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/backend/nginx.html" class="nav-link">
  nginx
</a></li><li class="dropdown-item"><!----> <a href="/backend/springboot.html" class="nav-link">
  springboot
</a></li><li class="dropdown-item"><!----> <a href="/backend/mybatis.html" class="nav-link">
  mybatis
</a></li><li class="dropdown-item"><!----> <a href="/backend/uml.html" class="nav-link">
  uml类图
</a></li><li class="dropdown-item"><!----> <a href="/backend/ddd.html" class="nav-link">
  领域驱动设计
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="js" class="dropdown-title"><span class="title">js</span> <span class="arrow down"></span></button> <button type="button" aria-label="js" class="mobile-dropdown-title"><span class="title">js</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frontend/js/" class="nav-link">
  js杂记
</a></li><li class="dropdown-item"><!----> <a href="/frontend/js/promise.html" class="nav-link">
  Promise规范和应用
</a></li><li class="dropdown-item"><!----> <a href="/frontend/js/browser.html" class="nav-link">
  浏览器对象详解
</a></li><li class="dropdown-item"><!----> <a href="/frontend/js/js_oop.html" class="nav-link">
  面向对象编程
</a></li><li class="dropdown-item"><!----> <a href="/frontend/js/ES6.html" class="nav-link">
  ES6ESNext规范详解
</a></li><li class="dropdown-item"><!----> <a href="/frontend/js/this_chain.html" class="nav-link">
  this指针作用域
</a></li><li class="dropdown-item"><!----> <a href="/frontend/js/typescript.html" class="nav-link">
  ts初探
</a></li><li class="dropdown-item"><!----> <a href="/frontend/ts/basics.html" class="nav-link">
  ts基础
</a></li><li class="dropdown-item"><!----> <a href="/frontend/ts/project.html" class="nav-link">
  ts工程
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工程化" class="dropdown-title"><span class="title">工程化</span> <span class="arrow down"></span></button> <button type="button" aria-label="工程化" class="mobile-dropdown-title"><span class="title">工程化</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frontend/tools/js_module.html" class="nav-link">
  模块化规范
</a></li><li class="dropdown-item"><!----> <a href="/frontend/tools/js_project.html" class="nav-link">
  前端工程化
</a></li><li class="dropdown-item"><!----> <a href="/frontend/tools/webpack.html" class="nav-link">
  webpack
</a></li><li class="dropdown-item"><!----> <a href="/frontend/tools/babel.html" class="nav-link">
  babel
</a></li><li class="dropdown-item"><!----> <a href="/frontend/tools/autotest.html" class="nav-link">
  自动化测试和部署
</a></li><li class="dropdown-item"><!----> <a href="/frontend/tools/ast.html" class="nav-link">
  AST
</a></li><li class="dropdown-item"><!----> <a href="/frontend/tools/solution.html" class="nav-link">
  前端方案
</a></li><li class="dropdown-item"><!----> <a href="/frontend/tools/js_tools.html" class="nav-link">
  常用工具
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="vue" class="dropdown-title"><span class="title">vue</span> <span class="arrow down"></span></button> <button type="button" aria-label="vue" class="mobile-dropdown-title"><span class="title">vue</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frontend/vue/index.html" class="nav-link">
  vue2.0基础
</a></li><li class="dropdown-item"><!----> <a href="/frontend/vue/advance.html" class="nav-link">
  vue2.0进阶
</a></li><li class="dropdown-item"><!----> <a href="/frontend/vue/vue-cli.html" class="nav-link">
  vue-cli
</a></li><li class="dropdown-item"><!----> <a href="/frontend/vue/vue-loader.html" class="nav-link">
  vue-loader
</a></li><li class="dropdown-item"><!----> <a href="/frontend/vue/vue-router.html" class="nav-link">
  vue-router
</a></li><li class="dropdown-item"><!----> <a href="/frontend/vue/vuex.html" class="nav-link">
  vuex
</a></li><li class="dropdown-item"><!----> <a href="/frontend/vue/vue_ssr.html" class="nav-link">
  vue-ssr
</a></li><li class="dropdown-item"><!----> <a href="/frontend/vue/vue-i18n.html" class="nav-link">
  vue-i18n
</a></li><li class="dropdown-item"><!----> <a href="/frontend/vue/vue-life.html" class="nav-link">
  生命周期
</a></li><li class="dropdown-item"><!----> <a href="/frontend/vue/vue_reactive.html" class="nav-link">
  响应式原理
</a></li><li class="dropdown-item"><!----> <a href="/frontend/vue/vue_diff.html" class="nav-link">
  diff原理
</a></li><li class="dropdown-item"><!----> <a href="/frontend/vue/vue-compiler.html" class="nav-link">
  编译原理
</a></li><li class="dropdown-item"><!----> <a href="/frontend/vue/vue-refs.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  实战总结
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="react" class="dropdown-title"><span class="title">react</span> <span class="arrow down"></span></button> <button type="button" aria-label="react" class="mobile-dropdown-title"><span class="title">react</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frontend/react/react.html" class="nav-link">
  react基础
</a></li><li class="dropdown-item"><!----> <a href="/frontend/react/react-advance.html" class="nav-link">
  react进阶
</a></li><li class="dropdown-item"><!----> <a href="/frontend/react/react-router.html" class="nav-link">
  react-router
</a></li><li class="dropdown-item"><!----> <a href="/frontend/react/react-state.html" class="nav-link">
  react状态管理
</a></li><li class="dropdown-item"><!----> <a href="/frontend/react/react-ssr.html" class="nav-link">
  react同构
</a></li><li class="dropdown-item"><!----> <a href="/frontend/react/react-component.html" class="nav-link">
  react组件封装
</a></li><li class="dropdown-item"><!----> <a href="/frontend/react/react-code.html" class="nav-link">
  react源码分析
</a></li><li class="dropdown-item"><!----> <a href="/frontend/ts/react-ts.html" class="nav-link">
  react-ts实战
</a></li><li class="dropdown-item"><!----> <a href="/frontend/react/react-practice.html" class="nav-link">
  react问题整理
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="nodejs" class="dropdown-title"><span class="title">nodejs</span> <span class="arrow down"></span></button> <button type="button" aria-label="nodejs" class="mobile-dropdown-title"><span class="title">nodejs</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frontend/nodejs/index.html" class="nav-link">
  nodejs基础
</a></li><li class="dropdown-item"><!----> <a href="/frontend/nodejs/module.html" class="nav-link">
  nodejs常用框架
</a></li><li class="dropdown-item"><!----> <a href="/frontend/nodejs/http.html" class="nav-link">
  nodejs网络及部署
</a></li><li class="dropdown-item"><!----> <a href="/frontend/ts/express-ts.html" class="nav-link">
  express-ts实战
</a></li><li class="dropdown-item"><!----> <a href="/frontend/nodejs/info.html" class="nav-link">
  nodejs前研
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他" class="dropdown-title"><span class="title">其他</span> <span class="arrow down"></span></button> <button type="button" aria-label="其他" class="mobile-dropdown-title"><span class="title">其他</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frontend/interview/" class="nav-link">
  前端面试
</a></li><li class="dropdown-item"><!----> <a href="/frontend/performance/performance.html" class="nav-link">
  前端性能优化
</a></li><li class="dropdown-item"><!----> <a href="/frontend/performance/explorer.html" class="nav-link">
  浏览器进程和线程
</a></li><li class="dropdown-item"><!----> <a href="/frontend/else/security-control.html" class="nav-link">
  前端网络安全
</a></li><li class="dropdown-item"><!----> <a href="/frontend/lowcode/lowcode.html" class="nav-link">
  低代码平台
</a></li><li class="dropdown-item"><!----> <a href="/frontend/else/micro-frontend.html" class="nav-link">
  微前端
</a></li><li class="dropdown-item"><!----> <a href="/frontend/else/designMode.html" class="nav-link">
  前端设计模式
</a></li><li class="dropdown-item"><!----> <a href="/frontend/css/" class="nav-link">
  css
</a></li><li class="dropdown-item"><!----> <a href="/frontend/mini-program/" class="nav-link">
  小程序
</a></li><li class="dropdown-item"><!----> <a href="/frontend/hybrid/hybrid.html" class="nav-link">
  hybrid开发及原理分析
</a></li><li class="dropdown-item"><!----> <a href="/frontend/else/canvas.html" class="nav-link">
  canvas
</a></li><li class="dropdown-item"><!----> <a href="/frontend/else/graph.html" class="nav-link">
  图片格式
</a></li><li class="dropdown-item"><!----> <a href="/frontend/else/web3.html" class="nav-link">
  web3探索
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="算法" class="dropdown-title"><span class="title">算法</span> <span class="arrow down"></span></button> <button type="button" aria-label="算法" class="mobile-dropdown-title"><span class="title">算法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frontend/algorithm/graph.html" class="nav-link">
  图的存储和遍历
</a></li><li class="dropdown-item"><!----> <a href="/frontend/algorithm/dpointer.html" class="nav-link">
  双指针
</a></li><li class="dropdown-item"><!----> <a href="/frontend/algorithm/Levenshtein.html" class="nav-link">
  最短编辑距离
</a></li><li class="dropdown-item"><!----> <a href="/frontend/algorithm/greed.html" class="nav-link">
  贪心算法
</a></li><li class="dropdown-item"><!----> <a href="/frontend/algorithm/dp.html" class="nav-link">
  动态规划
</a></li><li class="dropdown-item"><!----> <a href="/frontend/algorithm/leetcode.html" class="nav-link">
  leetcode
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端" class="dropdown-title"><span class="title">后端</span> <span class="arrow down"></span></button> <button type="button" aria-label="后端" class="mobile-dropdown-title"><span class="title">后端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/backend/nginx.html" class="nav-link">
  nginx
</a></li><li class="dropdown-item"><!----> <a href="/backend/springboot.html" class="nav-link">
  springboot
</a></li><li class="dropdown-item"><!----> <a href="/backend/mybatis.html" class="nav-link">
  mybatis
</a></li><li class="dropdown-item"><!----> <a href="/backend/uml.html" class="nav-link">
  uml类图
</a></li><li class="dropdown-item"><!----> <a href="/backend/ddd.html" class="nav-link">
  领域驱动设计
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>vue实战总结</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/frontend/vue/vue-refs.html#_1、开发技巧" class="sidebar-link">1、开发技巧</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/frontend/vue/vue-refs.html#_1、attrs和inheritattrs" class="sidebar-link">1、attrs和inheritAttrs</a></li><li class="sidebar-sub-header"><a href="/frontend/vue/vue-refs.html#_2、异步事件问题" class="sidebar-link">2、异步事件问题</a></li></ul></li><li><a href="/frontend/vue/vue-refs.html#_2、性能优化" class="sidebar-link">2、性能优化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/frontend/vue/vue-refs.html#_1、fp首屏加载优化" class="sidebar-link">1、FP首屏加载优化</a></li><li class="sidebar-sub-header"><a href="/frontend/vue/vue-refs.html#_2、非响应式处理" class="sidebar-link">2、非响应式处理</a></li></ul></li><li><a href="/frontend/vue/vue-refs.html#_3、工程化实践" class="sidebar-link">3、工程化实践</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/frontend/vue/vue-refs.html#_1、模块解耦" class="sidebar-link">1、模块解耦</a></li><li class="sidebar-sub-header"><a href="/frontend/vue/vue-refs.html#_2、mock方案" class="sidebar-link">2、mock方案</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="vue实战总结"><a href="#vue实战总结" class="header-anchor">#</a> vue实战总结</h1> <h2 id="_1、开发技巧"><a href="#_1、开发技巧" class="header-anchor">#</a> 1、开发技巧</h2> <h3 id="_1、attrs和inheritattrs"><a href="#_1、attrs和inheritattrs" class="header-anchor">#</a> 1、attrs和inheritAttrs</h3> <p>通过arrtrs和inheritAttrs实现属性透传：</p> <ul><li>$props：props声明的属性</li> <li>$attrs：非申明props的属性，用于组件封装属性透传，除style和class外，两者依然绑定在根组件上</li> <li>inheritAttrs：根元素不继承父元素设置的属性</li></ul> <div class="language-vue line-numbers-mode"><pre class="language-vue"><code><span class="token comment">&lt;!-- 子组件LinkButton --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>link-button<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">:href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>linkHref<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-bind</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>$attrs<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    <span class="token comment">//知识点1：通过arrtrs和inheritAttrs实现属性透传：</span>
    <span class="token comment">//$props props声明的属性</span>
    <span class="token comment">//$attrs 非申声明props的属性，用于组件封装属性透传，除去style和class仍然绑定在根组件上</span>
    <span class="token literal-property property">inheritAttrs</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">//根元素不继承父元素设置属性</span>
    <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">linkHref</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token literal-property property">type</span><span class="token operator">:</span> String<span class="token punctuation">,</span>
            <span class="token literal-property property">require</span><span class="token operator">:</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 父组件使用LinkButton --&gt;</span>
<span class="token comment">&lt;!-- 解析结果：设置inhertAttrs为false时，target、rel属性会透传至a元素上，class会作用在根元素上 --&gt;</span>
<span class="token comment">&lt;!-- 最终结果：
&lt;div class=&quot;button link-button&quot;&gt;
    &lt;a href=&quot;/&quot; target=&quot;_blank&quot; rel=&quot;nofollow noreferrer noopener&quot;&gt;热点&lt;/a&gt;
&lt;/div&gt; --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link-button</span> <span class="token attr-name">linkHref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/<span class="token punctuation">&quot;</span></span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>_blank<span class="token punctuation">&quot;</span></span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>nofollow noreferrer noopener<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>button<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>热点<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>link-button</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><p>解析：a标签的属性noopener, noreferrer 及 nofollow，参考资料：<a href="https://zhuanlan.zhihu.com/p/366736912" target="_blank" rel="noopener noreferrer">noopener等使用<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>a标签通常搭配：noopener、noreferre、nofollow属性使用，保证安全：</p> <ul><li><p>noopener：给链接加上target=&quot;_blank&quot;后，目标网页会在新链接中打开，此时新网页可通过window.opener获取到源页面的window对象，存在安全隐患。eg：第三方页面可通过window.opener.href = &quot;xxx&quot; 进行钓鱼。 设置后，第三方页面window.opener=null</p></li> <li><p>noreferrer：与noopener类似，同时新开页面中还无法获取 document.referrer 信息， 该信息包含了来源页面的地址。通常 noopener 和 noreferrer 会同时设置， rel=&quot;noopener noreferrer&quot;。为了浏览器兼容，老的浏览器不支持noopener</p></li> <li><p>nofollow 不要继续爬虫；搜索引擎对页面的权重计算中包含一项页面引用数 (backlinks),告诉搜索引擎， 本次链接不为上述排名作贡献</p></li></ul> <h3 id="_2、异步事件问题"><a href="#_2、异步事件问题" class="header-anchor">#</a> 2、异步事件问题</h3> <p>单值异步问题：点击按钮1，再点击按钮2，应该展示2，因为1回调展示了按钮1</p> <ul><li><p>方案一：数据结构变更</p></li> <li><p>方案二：提取异步函数，点击按钮1，再点击2时，停止按钮1的事件，发起按钮2的事件</p> <div class="language-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>changeMsg(1, 2000)<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>按钮1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>changeMsg(2)<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>按钮2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">''</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">methods</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token function">changeMsg</span><span class="token punctuation">(</span><span class="token parameter">val<span class="token punctuation">,</span> time<span class="token operator">=</span><span class="token number">100</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>message <span class="token operator">=</span> val
      <span class="token punctuation">}</span><span class="token punctuation">,</span> time<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 方案一：数据结构转变 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>changeMsg(msg.btn1, 1, 2000)<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>按钮1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>changeMsg(msg.btn2, 2)<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>按钮2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
      <span class="token literal-property property">msg</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">btn1</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span>
        <span class="token literal-property property">btn2</span><span class="token operator">:</span> <span class="token string">''</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">methods</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token function">changeMsg</span><span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> time<span class="token operator">=</span><span class="token number">100</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>message<span class="token operator">=</span>key
      <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        key <span class="token operator">=</span> value
      <span class="token punctuation">}</span><span class="token punctuation">,</span> time<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 方案二：提取函数进行防抖处理 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>timer <span class="token operator">=</span> <span class="token keyword">null</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">''</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">methods</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token function">changeMsg</span><span class="token punctuation">(</span><span class="token parameter">val<span class="token punctuation">,</span> time<span class="token operator">=</span><span class="token number">100</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token function">clearTimeout</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>timer<span class="token punctuation">)</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>message <span class="token operator">=</span> val
      <span class="token punctuation">}</span><span class="token punctuation">,</span> time<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br></div></div></li></ul> <h2 id="_2、性能优化"><a href="#_2、性能优化" class="header-anchor">#</a> 2、性能优化</h2> <h3 id="_1、fp首屏加载优化"><a href="#_1、fp首屏加载优化" class="header-anchor">#</a> 1、FP首屏加载优化</h3> <h4 id="_1、减小vendor大小"><a href="#_1、减小vendor大小" class="header-anchor">#</a> 1、减小vendor大小</h4> <p>可使用大文件分析插件查看占用资源：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// npm install --save-dev webpack-bundle-analyzer</span>
<span class="token keyword">const</span> BundleAnalyzerPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack-bundle-analyzer'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>BundleAnalyzerPlugin<span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">BundleAnalyzerPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li>cdn加速（剥离外部引用）</li></ul> <p>引入工程中的所有js、css文件，编译时会打包进vendor.js，vendor太大加载时间较长，影响首屏体验。</p> <p>解决方法：将外部js、css文件剥离，用资源的形式引用，浏览器可以使用多个异步线程将vendor.js 、外部的js等进行价值，达到加速首开目的。外部文件可以使用cdn资源，或别的服务器资源。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//1、vue.config.js配置</span>
<span class="token comment">//添加externals，忽略不需要打包的库</span>
<span class="token comment">//'vue-router':'VueRouter'解析：</span>
<span class="token comment">// 其中'vue-router'为引入的资源的名字，import vueRouter from 'vue-router'</span>
<span class="token comment">// 其中'VueRouter'为该模块提供给外部引用的名字，由对应的库自定，可在min.js中查看</span>
<span class="token literal-property property">configureWebpack</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">externals</span><span class="token operator">:</span><span class="token punctuation">{</span>
     <span class="token string-property property">'vue'</span><span class="token operator">:</span><span class="token string">'Vue'</span><span class="token punctuation">,</span>
     <span class="token string-property property">'vue-router'</span><span class="token operator">:</span><span class="token string">'VueRouter'</span><span class="token punctuation">,</span>
     <span class="token string-property property">'vuex'</span><span class="token operator">:</span><span class="token string">'Vuex'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">//2、html引入静态资源</span>
<span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">&quot;//cdn.bootcss.com/vue-router/2.3.0/vue-router.min.js&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>

<span class="token comment">//3、去掉import引用</span>
<span class="token comment">//import Router from 'vue-router'</span>
<span class="token comment">//Vue.use(Router)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><ul><li>路由懒加载</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">&quot;/list&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;List&quot;</span><span class="token punctuation">,</span>
        <span class="token comment">// route level code-splitting</span>
        <span class="token comment">// this generates a separate chunk (about.[hash].js) for this route</span>
        <span class="token comment">// which is lazy-loaded when the route is visited.</span>
        <span class="token function-variable function">component</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
            <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/* webpackChunkName: &quot;list&quot; */</span> <span class="token string">&quot;@/views/list/List.vue&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><ul><li>组件按需引用</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//1、安装babel-plugin-component</span>
<span class="token comment">//npm install babel-plugin-component -D</span>

<span class="token comment">//2、修改babel配置：.babelrc、babel.config.js</span>
<span class="token punctuation">{</span>
  <span class="token string-property property">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">&quot;es2015&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;modules&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;plugins&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span>
      <span class="token string">&quot;component&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token string-property property">&quot;libraryName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;element-ui&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;styleLibraryName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;theme-chalk&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token comment">//3、组件按需使用</span>
<span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Button<span class="token punctuation">,</span> Select <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'element-ui'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./App.vue'</span><span class="token punctuation">;</span>

Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span>Button<span class="token punctuation">.</span>name<span class="token punctuation">,</span> Button<span class="token punctuation">)</span><span class="token punctuation">;</span>
Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span>Select<span class="token punctuation">.</span>name<span class="token punctuation">,</span> Select<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/* 或写为
 * Vue.use(Button)
 * Vue.use(Select)
 */</span>

<span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">el</span><span class="token operator">:</span> <span class="token string">'#app'</span><span class="token punctuation">,</span>
  <span class="token function-variable function">render</span><span class="token operator">:</span> <span class="token parameter">h</span> <span class="token operator">=&gt;</span> <span class="token function">h</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br></div></div><h4 id="_2、服务器开启gizp"><a href="#_2、服务器开启gizp" class="header-anchor">#</a> 2、服务器开启gizp</h4> <p>参考资料：<a href="https://www.cnblogs.com/zigood/p/12504401.html" target="_blank" rel="noopener noreferrer">Vue项目 webpack优化 compression-webpack-plugin 开启gzip<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>Gzip是Gun zip的缩写，它将浏览器请求的文件先在服务器端进行压缩，然后传递给浏览器，浏览器解压之后再进行页面的解析工作。在服务端开启Gzip支持后，我们前端需要提供资源压缩包，对于的gzip包，浏览器如果支持gzip，会自动查找有没有gz文件，找到了就加载gz然后本地解压执行。</p> <ul><li>使用compression-webpack-plugin插件，对每个js和css文件增加输出gz后缀的文件。</li> <li>配置服务器支持gzip包</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//1、安装插件</span>
<span class="token comment">// npm install --save-dev compression-webpack-plugin</span>

<span class="token comment">//2、配置插件：生产环境，开启js\css压缩</span>
<span class="token keyword">const</span> CompressionPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'compression-webpack-plugin'</span><span class="token punctuation">)</span>
<span class="token function-variable function">chainWebpack</span><span class="token operator">:</span> <span class="token parameter">config</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">'production'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    config<span class="token punctuation">.</span><span class="token function">plugin</span><span class="token punctuation">(</span><span class="token string">'compressionPlugin'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">CompressionPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(js|css)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token comment">// 匹配文件名</span>
      <span class="token literal-property property">threshold</span><span class="token operator">:</span> <span class="token number">10240</span><span class="token punctuation">,</span> <span class="token comment">// 对超过10k的数据压缩</span>
      <span class="token literal-property property">minRatio</span><span class="token operator">:</span> <span class="token number">0.8</span><span class="token punctuation">,</span>
      <span class="token literal-property property">deleteOriginalAssets</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token comment">// 删除源文件</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">//3、nginx服务器配置gzip支持</span>
gzip on<span class="token punctuation">;</span>
gzip_static on<span class="token punctuation">;</span>
gzip_min_length 1k<span class="token punctuation">;</span>
gzip_buffers <span class="token number">4</span> 32k<span class="token punctuation">;</span>
gzip_http_version <span class="token number">1.1</span><span class="token punctuation">;</span>
gzip_comp_level <span class="token number">2</span><span class="token punctuation">;</span>
gzip_types text<span class="token operator">/</span>plain application<span class="token operator">/</span>x<span class="token operator">-</span>javascript text<span class="token operator">/</span>css application<span class="token operator">/</span>xml<span class="token punctuation">;</span>
gzip_vary on<span class="token punctuation">;</span>
gzip_disable <span class="token string">&quot;MSIE [1-6].&quot;</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h3 id="_2、非响应式处理"><a href="#_2、非响应式处理" class="header-anchor">#</a> 2、非响应式处理</h3> <p>对于从始至终都未改变的死数据，比如写死的下拉框和表格数据，无需进行响应式处理，减少性能消耗。</p> <ul><li>将数据定义在data之外</li> <li>使用object.freeze()</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>list1 <span class="token operator">=</span> <span class="token punctuation">{</span>xxx<span class="token punctuation">}</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>list2 <span class="token operator">=</span> <span class="token punctuation">{</span>xxx<span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    xxxx
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token function">data</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">list1</span><span class="token operator">:</span> Object<span class="token punctuation">.</span><span class="token function">freeze</span><span class="token punctuation">(</span><span class="token punctuation">{</span>xxx<span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token literal-property property">list2</span><span class="token operator">:</span> Object<span class="token punctuation">.</span><span class="token function">freeze</span><span class="token punctuation">(</span><span class="token punctuation">{</span>xxx<span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>解析：Object.freeze() 作用冻结一个对象， 返回和传入的参数相同的对象，一个被冻结的对象再也不能被修改</p> <ul><li><p>不能向这个对象添加新的属性，不能删除已有属性</p></li> <li><p>不能修改已有属性的值</p></li> <li><p>不能修改该对象已有属性的可枚举性、可配置性、可写性</p></li> <li><p>冻结一个对象后该对象的原型也不能被修改。</p></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token comment">// vue不会对list里的object做getter、setter绑定</span>
      <span class="token literal-property property">list</span><span class="token operator">:</span> Object<span class="token punctuation">.</span><span class="token function">freeze</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
        <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span>
      <span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">created</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 界面不会有响应</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>

      <span class="token comment">// 下面两种做法，界面都会响应</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>list <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">100</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">200</span> <span class="token punctuation">}</span>
      <span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>list <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">freeze</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
        <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">100</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token number">200</span> <span class="token punctuation">}</span>
      <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>参考资料：<a href="https://juejin.cn/post/6844903922469961741" target="_blank" rel="noopener noreferrer">Vue性能提升之Object.freeze()<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="_3、工程化实践"><a href="#_3、工程化实践" class="header-anchor">#</a> 3、工程化实践</h2> <h3 id="_1、模块解耦"><a href="#_1、模块解耦" class="header-anchor">#</a> 1、模块解耦</h3> <p>将全局的store、router、mock、i18n公共文件离散化处理剥离在各业务模块内，提高模块的内聚程度，方便功能移植，实现模块解耦</p> <h4 id="_1、require-context"><a href="#_1、require-context" class="header-anchor">#</a> 1、require.context</h4> <p>使用webpack的api实现代码自动导入，初始化时自动解析导入，实现route、store等解耦拆分</p> <p>require.context在webpack解析打包时自动执行。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//入参解析</span>
require<span class="token punctuation">.</span><span class="token function">context</span><span class="token punctuation">(</span>
  directory<span class="token punctuation">,</span>    							 <span class="token comment">//读取文件的路径</span>
  <span class="token punctuation">(</span>useSubdirectories <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment">//是否遍历文件的子目录</span>
  <span class="token punctuation">(</span>regExp <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^\.\/.*$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>       <span class="token comment">//要匹配文件的正则 </span>
  <span class="token punctuation">(</span>mode <span class="token operator">=</span> <span class="token string">'sync'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//输出解析</span>
<span class="token comment">/* 
1、输出为函数 webpackContext(req)
1.1、webpackContext函数，入参为路径，出参为模块，可取出defalut模块
1.2、函数也是对象，可有属性
2、输出的函数有三个属性，keys、id、resolve
2.1、resolve{Function} -接受一个参数request,request为test文件夹下面匹配文件的相对路径,返回这个匹配文件相对于整个工程的相对路径
2.2、keys {Function} -返回匹配成功模块的名字组成的数组
2.3、id {String} -执行环境的id,返回的是一个字符串,主要用在module.hot.accept
*/</span>

<span class="token comment">//示例：index.js  ./modules/home.js</span>
<span class="token keyword">const</span> modulesFiles <span class="token operator">=</span> require<span class="token punctuation">.</span><span class="token function">context</span><span class="token punctuation">(</span><span class="token string">'./modules'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>modulesFiles<span class="token punctuation">)</span>
<span class="token comment">/*
ƒ webpackContext(req) {
	var id = webpackContextResolve(req);
	return __webpack_require__(id);
}
*/</span>

console<span class="token punctuation">.</span><span class="token function">dir</span><span class="token punctuation">(</span>modulesFiles<span class="token punctuation">)</span>
<span class="token comment">/*
ƒ webpackContext(req)
id: &quot;./src/store/modules sync recursive \\.js$&quot;
keys: ƒ webpackContextKeys()
resolve: ƒ webpackContextResolve(req)
*/</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>modulesFiles<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">//[&quot;./home.js&quot;]</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>modulesFiles<span class="token punctuation">.</span>id<span class="token punctuation">)</span>
<span class="token comment">//./src/store/modules sync recursive \.js$</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>modulesFiles<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'./home.js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">//./src/store/modules/home.js</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">modulesFiles</span><span class="token punctuation">(</span><span class="token string">'./home.js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">/*
Module
default: {namespaced: true, state: {…}, getters: {…}, mutations: {…}}
*/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br></div></div><ul><li>store解耦合</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Vuex <span class="token keyword">from</span> <span class="token string">&quot;vuex&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> actions <span class="token keyword">from</span> <span class="token string">&quot;./actions.js&quot;</span>
<span class="token keyword">import</span> state <span class="token keyword">from</span> <span class="token string">&quot;./state.js&quot;</span>
<span class="token keyword">import</span> mutations <span class="token keyword">from</span> <span class="token string">&quot;./mutations.js&quot;</span>

Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>Vuex<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> store <span class="token operator">=</span> <span class="token punctuation">{</span>
  state<span class="token punctuation">,</span>
  actions<span class="token punctuation">,</span>
  mutations
<span class="token punctuation">}</span>
<span class="token keyword">const</span> modulesFiles <span class="token operator">=</span> require<span class="token punctuation">.</span><span class="token function">context</span><span class="token punctuation">(</span><span class="token string">'./modules'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span>
<span class="token keyword">const</span> modules <span class="token operator">=</span> modulesFiles<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">modules<span class="token punctuation">,</span> modulePath</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
  		<span class="token comment">//['./home.js']  ./home.js -&gt; home</span>
      <span class="token keyword">const</span> moduleName <span class="token operator">=</span> modulePath<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^\.\/(.*)\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token string">'$1'</span><span class="token punctuation">)</span>
      <span class="token keyword">const</span> module <span class="token operator">=</span> <span class="token function">modulesFiles</span><span class="token punctuation">(</span>modulePath<span class="token punctuation">)</span><span class="token punctuation">.</span>default
      modules<span class="token punctuation">[</span>moduleName<span class="token punctuation">]</span> <span class="token operator">=</span> module
      <span class="token keyword">return</span> modules
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
store <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token operator">...</span>store<span class="token punctuation">,</span> modules<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">new</span> <span class="token class-name">Vuex<span class="token punctuation">.</span>Store</span><span class="token punctuation">(</span>store<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/*
array.reduce(function(total, currentValue, currentIndex, arr), initialValue)
1、total 必需，初始值, 或者计算结束后的返回值
2、currentValue	必需，当前元素
3、currentIndex	可选，当前元素的索引
4、arr	可选，当前元素所属的数组对象
5、initialValue 可选，传递给函数的初始值
*/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><h4 id="_2、使用register方法"><a href="#_2、使用register方法" class="header-anchor">#</a> 2、使用register方法</h4> <p>重写vue类，子组件使用重写类，重写beforeCreate和destoryed方法，store、i18n、router通过参数传入后在beforeCreate注入，在destoryed中销毁，实现模块的解耦。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//方法调用</span>
<span class="token comment">/**
 * 功能：vuee重写vue，注入store、i18n
 * 输入：vuee(option, fieldMap, state)
 * vuee({
 *    data:{
 *    }
 * },
 * {
 *  state: {
 *     'self': ['a', 'b'],
 *     'global': ['c']
 *  },
 *  mutations: {
 *  },
 *  getters: {
 *  },
 *  actions: {
 *  },
 *  {
 *    mName: 'role',
 *    store,
 *    i18nEN,
 *    i18nZH
 *  }
 * }
 * )
 */</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>mapState<span class="token punctuation">,</span> mapActions<span class="token punctuation">,</span> mapMutations<span class="token punctuation">,</span> mapGetters<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vuex'</span>

<span class="token comment">//propsData: 创建实例时传入的props</span>
<span class="token keyword">const</span> <span class="token function-variable function">getNamespaceProp</span> <span class="token operator">=</span> <span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token operator">!</span>data <span class="token operator">||</span> <span class="token operator">!</span>data<span class="token punctuation">.</span>propsData<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string">''</span> <span class="token operator">:</span> data<span class="token punctuation">.</span>propsData<span class="token punctuation">.</span>namespace
<span class="token punctuation">}</span>

<span class="token comment">/**
 * store数据的通用map方法
 * @param {*} mName 视图的store模块名称
 * @param {*} mapData 需要映射的字段map
 * @param {*} type 映射的类型，包括state、action、getter和mutation
 * eg: mapExt(name, fieldMap.state, 'state')
 * fieldMap.state三种入参
 * ['a', 'b', 'c']
 * {
 *  state: {
 *     'self': ['a', 'b'],
 *     'global': ['c']
 *  }
 * }
 * {
 *  state: {
 *    'getTime': 'time'
 *  }
 * }
 */</span>
<span class="token keyword">const</span> mapExt <span class="token operator">=</span> <span class="token punctuation">(</span>mName<span class="token punctuation">,</span> mapData<span class="token punctuation">,</span> type<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>mapData<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">let</span> methodMap <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">state</span><span class="token operator">:</span> mapState<span class="token punctuation">,</span>
        <span class="token literal-property property">action</span><span class="token operator">:</span> mapActions<span class="token punctuation">,</span>
        <span class="token literal-property property">mutation</span><span class="token operator">:</span> mapMutations<span class="token punctuation">,</span>
        <span class="token literal-property property">getter</span><span class="token operator">:</span> mapGetters
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>mapData<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//mapActions('moduleA', ['getInfo', 'getTime']) //子模块</span>
        <span class="token comment">//mapGetters(['getInfo', 'getTime'])  全局</span>
        <span class="token keyword">return</span> mName <span class="token operator">?</span> methodMap<span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">(</span>mName<span class="token punctuation">,</span> mapData<span class="token punctuation">)</span> <span class="token operator">:</span> methodMap<span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">(</span>mapData<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> mapData <span class="token operator">===</span> <span class="token string">'object'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">let</span> simpleImport <span class="token operator">=</span> <span class="token boolean">false</span>
        <span class="token keyword">let</span> ret <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">of</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>mapData<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> mapData<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">'string'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                simpleImport <span class="token operator">=</span> <span class="token boolean">true</span>
                <span class="token keyword">break</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>key <span class="token operator">===</span> <span class="token string">'global'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                    ret <span class="token operator">=</span> <span class="token punctuation">{</span>
                        <span class="token operator">...</span>ret<span class="token punctuation">,</span>
                        <span class="token operator">...</span>methodMap<span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">(</span>mapData<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">root</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
                    ret <span class="token operator">=</span> <span class="token punctuation">{</span>
                        <span class="token operator">...</span>ret<span class="token punctuation">,</span>
                        <span class="token operator">...</span>methodMap<span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">(</span>key <span class="token operator">===</span> <span class="token string">'self'</span><span class="token operator">?</span> mName <span class="token operator">:</span> key<span class="token punctuation">,</span> mapData<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>simpleImport<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> mName <span class="token operator">?</span> methodMap<span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">(</span>mName<span class="token punctuation">,</span> mapData<span class="token punctuation">)</span> <span class="token operator">:</span> methodMap<span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">(</span>mapData<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> ret
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">vuee</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">options <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> fieldMap<span class="token punctuation">,</span> state</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> comInstance <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span>options <span class="token punctuation">}</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">let</span> <span class="token punctuation">{</span>mName<span class="token punctuation">,</span> store<span class="token punctuation">,</span> i18nEN<span class="token punctuation">,</span> i18nZH<span class="token punctuation">}</span> <span class="token operator">=</span> state
        <span class="token keyword">let</span> <span class="token punctuation">{</span>beforeCreate<span class="token punctuation">,</span> destroyed<span class="token punctuation">}</span> <span class="token operator">=</span> options
        <span class="token keyword">let</span> ns <span class="token operator">=</span> mName <span class="token operator">||</span> <span class="token function">getNamespaceProp</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>$options<span class="token punctuation">)</span>
        <span class="token comment">//namespace属性为true，namespace为ns/，否则为ns</span>
        <span class="token keyword">let</span> namespace <span class="token operator">=</span> store<span class="token punctuation">.</span>namespace <span class="token operator">?</span> ns <span class="token operator">+</span> <span class="token string">'/'</span> <span class="token operator">:</span> ns
        <span class="token keyword">let</span> module <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span>_modulesNamespaceMap<span class="token punctuation">[</span>namespace<span class="token punctuation">]</span>

        <span class="token comment">//重写beforeCreate</span>
        comInstance<span class="token punctuation">.</span><span class="token function-variable function">beforeCreate</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>module<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token comment">//新旧页面切换时，存在引入公用模块相同，新页面会丢失公用模块的数据状态，旧页面destoryed过程会发生在新页面beforeCreate之后</span>
      <span class="token comment">//通过给模块设置覆盖标记解决，只有模块状态未被覆盖时才允许卸载模块绑定数据</span>
                module<span class="token punctuation">.</span>$$overide <span class="token operator">=</span> <span class="token boolean">true</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">registerModule</span><span class="token punctuation">(</span>ns<span class="token punctuation">,</span> store<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>

            <span class="token comment">//i18扩展</span>
            <span class="token keyword">let</span> message <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$i18n<span class="token punctuation">.</span>message
            message<span class="token punctuation">.</span>en <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token operator">...</span>message<span class="token punctuation">.</span>en<span class="token punctuation">,</span> <span class="token operator">...</span>i18nEN<span class="token punctuation">}</span>
            message<span class="token punctuation">.</span>zh <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token operator">...</span>message<span class="token punctuation">.</span>en<span class="token punctuation">,</span> <span class="token operator">...</span>i18nZH<span class="token punctuation">}</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>$i18n<span class="token punctuation">.</span>message <span class="token operator">=</span> message

            beforeCreate <span class="token operator">&amp;&amp;</span> <span class="token function">beforeCreate</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//重写destoryed</span>
        comInstance<span class="token punctuation">.</span><span class="token function-variable function">destroyed</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>module<span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>module<span class="token punctuation">.</span>$$overide<span class="token punctuation">)</span><span class="token punctuation">{</span>
                    module<span class="token punctuation">.</span>$$overide <span class="token operator">=</span> <span class="token boolean">false</span>
                <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
                    <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">unregisterModule</span><span class="token punctuation">(</span>ns<span class="token punctuation">)</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">unregisterModule</span><span class="token punctuation">(</span>ns<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
            destroyed <span class="token operator">&amp;&amp;</span> <span class="token function">destroyed</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span>fieldMap<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">let</span> name <span class="token operator">=</span> state <span class="token operator">?</span> mName <span class="token operator">:</span> <span class="token keyword">null</span>
        comInstance<span class="token punctuation">.</span>computed <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token operator">...</span><span class="token function">mapExt</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> fieldMap<span class="token punctuation">.</span>state<span class="token punctuation">,</span> <span class="token string">'state'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token operator">...</span><span class="token function">mapExt</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> fieldMap<span class="token punctuation">.</span>getter<span class="token punctuation">,</span> <span class="token string">'getter'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token operator">...</span>options<span class="token punctuation">.</span>computed
        <span class="token punctuation">}</span>
        comInstance<span class="token punctuation">.</span>methods <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token operator">...</span><span class="token function">mapExt</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> fieldMap<span class="token punctuation">.</span>mutations<span class="token punctuation">,</span> <span class="token string">'mutation'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token operator">...</span><span class="token function">mapExt</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> fieldMap<span class="token punctuation">.</span>actions<span class="token punctuation">,</span> <span class="token string">'action'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token operator">...</span>options<span class="token punctuation">.</span>methods
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    options <span class="token operator">=</span> <span class="token keyword">null</span> <span class="token comment">//释放空间</span>
    <span class="token keyword">return</span> comInstance
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> vuee<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br></div></div><h4 id="_3、插件化机制"><a href="#_3、插件化机制" class="header-anchor">#</a> 3、插件化机制</h4> <p>将公用组件及模块配置成插件包，可通过动态安装插件实现功能扩展，参照umi结构</p> <ul><li>使用自动注册插件自动安装相关插件包或手动引入</li> <li>子定义插件
<ul><li>npm包形式
<ul><li>创建插件包，以@plugin开头，eg：@plugin/demo</li> <li>插件开发目录包含src目录，放置es6编写的index.js文件</li> <li>插件开发目录建立lib目录，放置babel编译过的index.js文件</li></ul></li> <li>本地方式：src/utils/plugin内新增插件</li></ul></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//插件接口：xPlugin.init(Vue, router, store, settings)</span>
<span class="token comment">//一、使用：main.js</span>
<span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'Vue'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> router <span class="token keyword">from</span> <span class="token string">'./router'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">'./store'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> settings <span class="token keyword">from</span> <span class="token string">'./settings'</span><span class="token punctuation">;</span>

<span class="token comment">//1、手动导入</span>
<span class="token keyword">import</span> xPlugin <span class="token keyword">from</span> <span class="token string">'@plugin/xPlugin'</span><span class="token punctuation">;</span>
xPlugin<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>Vue<span class="token punctuation">,</span> router<span class="token punctuation">,</span> store<span class="token punctuation">,</span> settings<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//2、自动导入：直接使用registerPlugin即可</span>
<span class="token keyword">import</span> registerPlugin <span class="token keyword">from</span> <span class="token string">'@plugin/register'</span><span class="token punctuation">;</span>
<span class="token function">registerPlugin</span><span class="token punctuation">(</span>Vue<span class="token punctuation">,</span> router<span class="token punctuation">,</span> store<span class="token punctuation">,</span> settings<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//会自动引入所有插件</span>

<span class="token comment">//二、插件结构：xPlugin</span>
<span class="token keyword">class</span> <span class="token class-name">xPlugin</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token parameter">Vue<span class="token punctuation">,</span> router<span class="token punctuation">,</span> store<span class="token punctuation">,</span> settings</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">router</span><span class="token punctuation">(</span>router<span class="token punctuation">,</span> store<span class="token punctuation">,</span> settings<span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">store</span><span class="token punctuation">(</span>store<span class="token punctuation">,</span> settings<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">static</span> <span class="token function">router</span><span class="token punctuation">(</span><span class="token parameter">router<span class="token punctuation">,</span> store<span class="token punctuation">,</span> settings</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token operator">...</span><span class="token operator">...</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">static</span> <span class="token function">store</span><span class="token punctuation">(</span><span class="token parameter">store<span class="token punctuation">,</span> settings</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token operator">...</span><span class="token operator">...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> xPlugin<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><h5 id="_1、自动注入插件"><a href="#_1、自动注入插件" class="header-anchor">#</a> 1、自动注入插件</h5> <ul><li>注册npm包插件：读取@plugin域下面的插件，并调用插件的init()方法执行，完成注册</li> <li>注册本地插件，执行插件的init()方法</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">/* 目录结构
-@plugin
	-register
	  -lib
	  -src
	  .babelrc
	  package.json
*/</span>

<span class="token comment">//.babelrc</span>
<span class="token punctuation">{</span>
  <span class="token string-property property">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;es2015&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token comment">//.package.json</span>
<span class="token punctuation">{</span>
  <span class="token string-property property">&quot;main&quot;</span><span class="token operator">:</span><span class="token string">&quot;/lib/index.js&quot;</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;scripts&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token string-property property">&quot;babel&quot;</span><span class="token operator">:</span> <span class="token string">&quot;babel -d lib/ src/&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;devDependencies&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token string-property property">&quot;babel&quot;</span><span class="token operator">:</span><span class="token string">&quot;^6.x.x&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;babel-cli&quot;</span><span class="token operator">:</span><span class="token string">&quot;^6.x.x&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;babel-preset-es2015&quot;</span><span class="token operator">:</span><span class="token string">&quot;^6.x.x&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// src/index.js</span>
<span class="token keyword">const</span> <span class="token function-variable function">registerPlugin</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">Vue<span class="token punctuation">,</span> router<span class="token punctuation">,</span> store<span class="token punctuation">,</span> settings</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> modulesFiles <span class="token operator">=</span> require<span class="token punctuation">.</span><span class="token function">context</span><span class="token punctuation">(</span><span class="token string">'@plugin'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">index.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//注册npm包插件</span>
  modulesFiles<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">modules<span class="token punctuation">,</span> modulePath</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>modulePath <span class="token operator">!==</span> <span class="token string">'./register/index.js'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      	<span class="token keyword">const</span> plugin <span class="token operator">=</span> <span class="token function">modulesFiles</span><span class="token punctuation">(</span>modulePath<span class="token punctuation">)</span>
        plugin<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>Vue<span class="token punctuation">,</span> router<span class="token punctuation">,</span> store<span class="token punctuation">,</span> settings<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//注册本地插件</span>
  <span class="token keyword">try</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> utilFiles <span class="token operator">=</span> require<span class="token punctuation">.</span><span class="token function">context</span><span class="token punctuation">(</span><span class="token string">'@/utils/plugin'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.js$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  	utilFiles<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">modules<span class="token punctuation">,</span> modulePath</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      	<span class="token keyword">const</span> plugin <span class="token operator">=</span> <span class="token function">utilFiles</span><span class="token punctuation">(</span>modulePath<span class="token punctuation">)</span>
        plugin<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>Vue<span class="token punctuation">,</span> router<span class="token punctuation">,</span> store<span class="token punctuation">,</span> settings<span class="token punctuation">)</span>
  	<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>code <span class="token operator">!==</span> <span class="token string">&quot;MODULE_NOT_FOUND&quot;</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> registerPlugin<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br></div></div><h5 id="_2、iframe插件"><a href="#_2、iframe插件" class="header-anchor">#</a> 2、iframe插件</h5> <ul><li>缓存用iframe标签加载的页面，避免切换路由时重复加载浪费性能</li> <li>可以使用传参来决定是否刷新当前页面，若不刷新，会缓存上一次组件实例，不毁摧毁</li> <li>原理
<ul><li>在布局时新建一个id为iframe-root的Dom节点，此节点与右侧内容区是兄弟节点</li> <li>把访问过的每一个iframe页面都当成一个子节点appendChild到iframe-root上</li> <li>切换路由时控制iframe页面节点的display属性为block或者none</li></ul></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//1、安装插件：npm install @plugin/iframe</span>

<span class="token comment">//2、注册插件：main.js</span>
<span class="token keyword">import</span> IframePlugin <span class="token keyword">from</span> <span class="token string">'@plugin/iframe'</span>
IframePlugin<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>Vue<span class="token punctuation">,</span> router<span class="token punctuation">,</span> store<span class="token punctuation">,</span> settings<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//3、使用插件</span>
<span class="token comment">//3.1、添加iframe-root的dom节点: main.vue</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 内包含：router<span class="token operator">-</span>view元素 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>main<span class="token operator">-</span>app id<span class="token operator">=</span><span class="token string">&quot;main-app&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>main<span class="token operator">-</span>app<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">&quot;iframe-root&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>

<span class="token comment">//3.2、配置参数: setting.js</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">iframeRoot</span><span class="token operator">:</span> <span class="token string">&quot;iframe-root&quot;</span><span class="token punctuation">,</span> 						<span class="token comment">//iframe容器标签id，用于append元素</span>
  <span class="token literal-property property">iframeComponent</span><span class="token operator">:</span> <span class="token string">&quot;iframeComponent&quot;</span><span class="token punctuation">,</span>		<span class="token comment">//iframe模块路由前缀</span>
  <span class="token literal-property property">routerView</span><span class="token operator">:</span> <span class="token string">&quot;main-app&quot;</span><span class="token punctuation">,</span>               <span class="token comment">//路由页面出口dom的id</span>
<span class="token punctuation">}</span>

<span class="token comment">//3.3、组件中调用setIframeUrl方法</span>
<span class="token literal-property property">methods</span><span class="token operator">:</span><span class="token punctuation">{</span>
  <span class="token function">showIframe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'iframe/setIframeUrl'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">'http://www.xxx.com'</span><span class="token punctuation">,</span>           <span class="token comment">//iframe地址</span>
      <span class="token literal-property property">refresh</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>                      <span class="token comment">//是否刷新</span>
      <span class="token literal-property property">oUrl</span><span class="token operator">:</span> <span class="token string">'/ifremeComponent/iframePage'</span>  <span class="token comment">//当前路由</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">//4、插件细节，结构同上，src/index.js</span>
<span class="token keyword">class</span> <span class="token class-name">IframePlugin</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token parameter">Vue<span class="token punctuation">,</span> router<span class="token punctuation">,</span> store<span class="token punctuation">,</span> settings</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">router</span><span class="token punctuation">(</span>router<span class="token punctuation">,</span> store<span class="token punctuation">,</span> settings<span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">store</span><span class="token punctuation">(</span>store<span class="token punctuation">,</span> settings<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">static</span> <span class="token function">router</span><span class="token punctuation">(</span><span class="token parameter">router<span class="token punctuation">,</span> store<span class="token punctuation">,</span> settings</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//router-view和iframe容器相互切换展示</span>
    <span class="token comment">//命中iframe的路由则展示iframe容器，router-view隐藏</span>
    router<span class="token punctuation">.</span><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> from<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      <span class="token keyword">const</span> isIframe <span class="token operator">=</span> to<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>settings<span class="token punctuation">.</span>iframeComponent<span class="token punctuation">)</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>from<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>settings<span class="token punctuation">.</span>iframeComponent<span class="token punctuation">)</span> <span class="token operator">!==</span> isIframe<span class="token punctuation">)</span><span class="token punctuation">{</span>
        store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'iframe/switchDisplay'</span><span class="token punctuation">,</span> isIframe<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
      <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">static</span> <span class="token function">store</span><span class="token punctuation">(</span><span class="token parameter">store<span class="token punctuation">,</span> settings</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">iframeSet</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">const</span> mutations <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token function-variable function">addIframe</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> newIframe</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> iframeDom <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'iframe'</span><span class="token punctuation">)</span>
        iframeDom<span class="token punctuation">.</span>src <span class="token operator">=</span> newIframe<span class="token punctuation">.</span>url
        iframeDom<span class="token punctuation">.</span>oUrl <span class="token operator">=</span> newIframe<span class="token punctuation">.</span>oUrl
        iframeDom<span class="token punctuation">.</span>className <span class="token operator">=</span> <span class="token string">'iframe'</span>
        document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span>settings<span class="token punctuation">.</span>iframeRoot<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>iframeDom<span class="token punctuation">)</span>
        state<span class="token punctuation">.</span>iframeSet<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token literal-property property">path</span><span class="token operator">:</span> newIframe<span class="token punctuation">.</span>url<span class="token punctuation">,</span>
          <span class="token literal-property property">oUrl</span><span class="token operator">:</span> newIframe<span class="token punctuation">.</span>oUrl
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token literal-property property">deleteSingleIframe</span><span class="token operator">:</span> <span class="token punctuation">(</span>state<span class="token punctuation">,</span> view<span class="token punctuation">)</span><span class="token punctuation">{</span>
      	<span class="token keyword">const</span> iframes <span class="token operator">=</span> document
      				<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span>settings<span class="token punctuation">.</span>iframeRoot<span class="token punctuation">)</span>
              <span class="token punctuation">.</span><span class="token function">getElementByTagName</span><span class="token punctuation">(</span><span class="token string">'iframe'</span><span class="token punctuation">)</span>
    		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>iframes<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">//remove dom</span>
          <span class="token keyword">if</span><span class="token punctuation">(</span>iframes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>oUrl <span class="token operator">===</span> view<span class="token punctuation">.</span>path<span class="token punctuation">)</span><span class="token punctuation">{</span>
            iframes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>parentNode<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>iframes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token punctuation">[</span>i<span class="token punctuation">,</span> v<span class="token punctuation">]</span> <span class="token keyword">of</span> state<span class="token punctuation">.</span>iframeSet<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
          <span class="token keyword">if</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span>oUrl <span class="token operator">===</span> view<span class="token punctuation">.</span>path<span class="token punctuation">)</span><span class="token punctuation">{</span>
            state<span class="token punctuation">.</span>iframeSet<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
            <span class="token keyword">break</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    	<span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function-variable function">switchIframe</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> newIframe</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> iframes <span class="token operator">=</span> document
      				<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span>settings<span class="token punctuation">.</span>iframeRoot<span class="token punctuation">)</span>
              <span class="token punctuation">.</span><span class="token function">getElementByTagName</span><span class="token punctuation">(</span><span class="token string">'iframe'</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span> iframes<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
          <span class="token keyword">if</span><span class="token punctuation">(</span>iframes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>oUrl <span class="token operator">===</span> newIframe<span class="token punctuation">.</span>oUrl<span class="token punctuation">)</span><span class="token punctuation">{</span>
            iframes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">'block'</span>
          <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
            iframes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">'none'</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function-variable function">switchDisplay</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span> isIFrame</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> <span class="token function-variable function">display</span> <span class="token operator">=</span> <span class="token parameter">bool</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>bool <span class="token operator">?</span> <span class="token string">'block'</span> <span class="token operator">:</span> <span class="token string">'none'</span><span class="token punctuation">)</span>
        <span class="token keyword">const</span> iframeRoot <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span>settings<span class="token punctuation">.</span>iframeRoot<span class="token punctuation">)</span>
        <span class="token keyword">const</span> routerView <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span>settings<span class="token punctuation">.</span>routerView<span class="token punctuation">)</span>
        iframeRoot <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>iframeRoot<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token function">display</span><span class="token punctuation">(</span>isIframe<span class="token punctuation">)</span><span class="token punctuation">)</span>
        routerView <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>routerView<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token function">display</span><span class="token punctuation">(</span><span class="token operator">!</span>isIframe<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">const</span> actions <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token function">setIframeUrl</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>commit<span class="token punctuation">,</span> state<span class="token punctuation">}</span><span class="token punctuation">,</span> iframe</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//some监测数组中是否有元素符合条件</span>
        <span class="token keyword">const</span> hasIframeUrl <span class="token operator">=</span> state<span class="token punctuation">.</span>iframeSet<span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span><span class="token parameter">el</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> el<span class="token punctuation">.</span>oUrl <span class="token operator">===</span> iframe<span class="token punctuation">.</span>oUrl
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>hasIframeUrl<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//not exist</span>
          <span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'addIframe'</span><span class="token punctuation">,</span> iframe<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>iframe<span class="token punctuation">.</span>refresh<span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//exist, refresh needed</span>
          <span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'deleteSingleIframe'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">path</span><span class="token operator">:</span> iframe<span class="token punctuation">.</span>oUrl<span class="token punctuation">}</span><span class="token punctuation">)</span>
          <span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'addIframe'</span><span class="token punctuation">,</span> iframe<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'switchIframe'</span><span class="token punctuation">,</span> iframe<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    store<span class="token punctuation">.</span><span class="token function">registerModule</span><span class="token punctuation">(</span><span class="token string">'iframe'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">namespaced</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      state<span class="token punctuation">,</span>
      mutations<span class="token punctuation">,</span>
      actions
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> IframePlugin<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br></div></div><h5 id="_3、微前端插件"><a href="#_3、微前端插件" class="header-anchor">#</a> 3、微前端插件</h5> <ul><li><p>原理</p> <ul><li>主应用初始化会加载配置文件解析得到所有子应用文件所在的节点列表</li> <li>进行功能切换时，主应用根据要跳转的路由在上述节点清单上找到对应子应用的节点入口并加载子应用静态文件，通过解析子应用静态文件通过调用Vuex等插件的api将子应用的信息注册至主应用中的vue实例上</li> <li>子应用信息注册完成后，主应用会加载对应组件并跳转至相应页面</li></ul></li> <li><p>主应用</p> <ul><li>使用微前端插件，将加载的子工程的静态资源地址赋值给script标签的src属性并append到html的body上</li> <li>将主工程的状态、路由、多语言文件挂接至Vue.prototype供子应用使用</li></ul></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 1、安装插件：npm install @plugin/microfrontendLoad</span>

<span class="token comment">// 2、配置及加载插件：main.js、settings.js、microFrontEndConfig.js</span>
<span class="token comment">// 2.1、main.js</span>
<span class="token keyword">import</span> microfrontendLoad <span class="token keyword">from</span> <span class="token string">'@plugin/microfrontendLoad'</span>
microfrontendLoad<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>Vue<span class="token punctuation">,</span> router<span class="token punctuation">,</span> store<span class="token punctuation">,</span> settings<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 2.2、settings.js</span>
<span class="token keyword">import</span> i18n <span class="token keyword">from</span> <span class="token string">'@/lang'</span>
<span class="token keyword">import</span> request <span class="token keyword">from</span> <span class="token string">'./utils/request'</span>
<span class="token keyword">import</span> Message <span class="token keyword">from</span> <span class="token string">'element-ui/packages/message/src/main'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span><span class="token constant">MICROAPPCONFIG</span><span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./microFrontEndConfig'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">microfrontentConfig</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">i18n</span><span class="token operator">:</span> i18n<span class="token punctuation">,</span>
    <span class="token literal-property property">request</span><span class="token operator">:</span> request<span class="token punctuation">,</span>
    <span class="token constant">MICRO_APP_CONFIG</span><span class="token operator">:</span> <span class="token constant">MICROAPPCONFIG</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 2.3、microFrontEndConfig.js</span>
window<span class="token punctuation">.</span>_baseUrl <span class="token operator">=</span> <span class="token string">''</span>
<span class="token keyword">const</span> <span class="token constant">MICROAPPCONFIG</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">devMenu</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">'childA'</span><span class="token punctuation">,</span>   <span class="token comment">//子应用唯一标识，用于避免重复加载资源</span>
      <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'childA'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/childA'</span><span class="token punctuation">,</span> <span class="token comment">//子应用路由前缀</span>
      <span class="token literal-property property">urlPath</span><span class="token operator">:</span> <span class="token string">'/app.js'</span><span class="token punctuation">,</span> <span class="token comment">//子应用入口文件</span>
      <span class="token literal-property property">origin</span><span class="token operator">:</span> <span class="token string">'http://localhost:8081'</span> 
      <span class="token comment">//子应用静态资源所在路径，通常配合nginx反向代理使用，使整体项目处于同一域名</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token comment">//开发环境</span>
  <span class="token literal-property property">normalMenu</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">'childA'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'childA'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/childA'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">urlPath</span><span class="token operator">:</span> <span class="token string">'/app.js'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">origin</span><span class="token operator">:</span> window<span class="token punctuation">.</span>_baseUrl <span class="token operator">+</span> <span class="token string">'/childA/js'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span> <span class="token comment">//生产环境，同上</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span><span class="token constant">MICROAPPCONFIG</span><span class="token punctuation">}</span>

<span class="token comment">// 3、插件结构同上，/src/index.js</span>
<span class="token keyword">function</span> <span class="token function">appendScript</span><span class="token punctuation">(</span><span class="token parameter">id<span class="token punctuation">,</span> url</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">const</span> script <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'script'</span><span class="token punctuation">)</span>
  script<span class="token punctuation">.</span>src <span class="token operator">=</span> url <span class="token operator">+</span> <span class="token string">'?t='</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  script<span class="token punctuation">.</span>id <span class="token operator">=</span> id
  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>script<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">microFrontendLoad</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token parameter">Vue<span class="token punctuation">,</span> router<span class="token punctuation">,</span> store<span class="token punctuation">,</span> settings</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span>Vue<span class="token punctuation">,</span> router<span class="token punctuation">,</span> store<span class="token punctuation">,</span> settings<span class="token punctuation">)</span>
    <span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">loadChild</span><span class="token punctuation">(</span>Vue<span class="token punctuation">,</span> router<span class="token punctuation">,</span> store<span class="token punctuation">,</span> settings<span class="token punctuation">)</span>
    config<span class="token punctuation">.</span><span class="token function">loadAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token comment">//挂载至全局供子应用使用</span>
  <span class="token keyword">static</span> <span class="token function">mount</span><span class="token punctuation">(</span><span class="token parameter">Vue<span class="token punctuation">,</span> router<span class="token punctuation">,</span> store<span class="token punctuation">,</span> settings</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span>i18n<span class="token punctuation">,</span> request<span class="token punctuation">}</span> <span class="token operator">=</span> settings<span class="token punctuation">.</span>microfrontendConfig
    <span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>_router <span class="token operator">=</span> router
    <span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>_store <span class="token operator">=</span> store
    <span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>_i18n <span class="token operator">=</span> i18n
    <span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>$request <span class="token operator">=</span> request
  <span class="token punctuation">}</span>
  <span class="token keyword">static</span> <span class="token function">loadChild</span><span class="token punctuation">(</span><span class="token parameter">Vue<span class="token punctuation">,</span> router<span class="token punctuation">,</span> store<span class="token punctuation">,</span> settings</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span><span class="token constant">MICRO_APP_CONFIG</span><span class="token punctuation">}</span> <span class="token operator">=</span> settings<span class="token punctuation">.</span>microfrontendConfig
    <span class="token keyword">const</span> online <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">'producting'</span>
    <span class="token keyword">const</span> devMenu <span class="token operator">=</span> <span class="token constant">MICRO_APP_CONFIG</span><span class="token punctuation">.</span>devMenu
    <span class="token keyword">const</span> normalMenu <span class="token operator">=</span> <span class="token constant">MICRO_APP_CONFIG</span><span class="token punctuation">.</span>normalMenu
    <span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">menu</span><span class="token operator">:</span> online <span class="token operator">?</span> normalMenu <span class="token operator">:</span> devMenu<span class="token punctuation">,</span>
      <span class="token literal-property property">current</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      <span class="token literal-property property">loadQueen</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function-variable function">load</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">item <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>current</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        item <span class="token operator">=</span> item <span class="token operator">||</span> <span class="token keyword">this</span><span class="token punctuation">.</span>menu<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>item<span class="token punctuation">)</span><span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;当前path，未匹配到路由菜单&quot;</span><span class="token punctuation">)</span>
          <span class="token keyword">return</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>current <span class="token operator">=</span> item
        <span class="token comment">//在主项目或非当前子项目 启动时才需要动态加载</span>
        <span class="token keyword">const</span> isCurrentProject <span class="token operator">=</span> location<span class="token punctuation">.</span>origin <span class="token operator">===</span> item<span class="token punctuation">.</span>origin
        <span class="token keyword">if</span><span class="token punctuation">(</span>isCurrentProject<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>loadQueen<span class="token punctuation">[</span>item<span class="token punctuation">.</span>id<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>loadQueen<span class="token punctuation">[</span>item<span class="token punctuation">.</span>id<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span>
          <span class="token function">appendScript</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>id<span class="token punctuation">,</span> item<span class="token punctuation">.</span>origin <span class="token operator">+</span> item<span class="token punctuation">.</span>urlPath<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function-variable function">loadAll</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>menu<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> thi<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function-variable function">getCurrent</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>current <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>menu<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token parameter">x</span> <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span>path <span class="token operator">===</span> location<span class="token punctuation">.</span>hash<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>current
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function-variable function">addWatch</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        router<span class="token punctuation">.</span><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> from<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">const</span> item <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>menu<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token parameter">x</span> <span class="token operator">=&gt;</span> to<span class="token punctuation">.</span>path<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span>path<span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
          <span class="token comment">//当访问路径属于某个子工程并且未加载时</span>
          <span class="token keyword">if</span><span class="token punctuation">(</span>item <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>loadQueen<span class="token punctuation">[</span>item<span class="token punctuation">.</span>id<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
          <span class="token punctuation">}</span>
          <span class="token keyword">if</span><span class="token punctuation">(</span>to<span class="token punctuation">.</span>matched<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;该功能正在加载或暂不可用，请稍后再试&quot;</span><span class="token punctuation">)</span>
            <span class="token function">next</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
            <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    
    config<span class="token punctuation">.</span><span class="token function">getCurrent</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;DOMContentLoaded&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
      config<span class="token punctuation">.</span><span class="token function">addWatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> config
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> microFrontendLoad<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br></div></div><ul><li>子应用：通过Vue.prototype注册信息，包括状态、多语言、路由</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>_router<span class="token punctuation">.</span><span class="token function">addRoutes</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">...</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>_store<span class="token punctuation">.</span><span class="token function">registerModule</span><span class="token punctuation">(</span>appName<span class="token punctuation">,</span> module<span class="token punctuation">)</span>
<span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>_i18n<span class="token punctuation">.</span><span class="token function">mergeLocaleMessage</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> lang<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>应用间通讯
<ul><li>单页面应用只有一个Vue实例，所以应用间通讯依赖Vue的原型</li> <li>对于主应用和子应用，运行时共享页面的location、window、localStorage等全局对象，可通过这些来实现</li></ul></li></ul> <h3 id="_2、mock方案"><a href="#_2、mock方案" class="header-anchor">#</a> 2、mock方案</h3> <p>参考资料1：<a href="https://www.cnblogs.com/l-y-h/archive/2019/10/17/11691110.html" target="_blank" rel="noopener noreferrer">vue中mock使用<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>参考资料2：<a href="https://www.cnblogs.com/l-y-h/p/12955001.html#_label2" target="_blank" rel="noopener noreferrer">axios和mock封装使用<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h4 id="_1、mock-js"><a href="#_1、mock-js" class="header-anchor">#</a> 1、mock.js</h4> <p>开发环境使用mock.js库，对请求进行拦截，无实际请求内容。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>Mock<span class="token punctuation">.</span><span class="token function">mock</span><span class="token punctuation">(</span> rurl<span class="token operator">?</span><span class="token punctuation">,</span> rtype<span class="token operator">?</span><span class="token punctuation">,</span> template <span class="token punctuation">)</span> <span class="token punctuation">)</span>
Mock<span class="token punctuation">.</span><span class="token function">mock</span><span class="token punctuation">(</span> rurl<span class="token punctuation">,</span> rtype<span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token parameter">options</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span>

<span class="token comment">/* 参数解析
1、rurl 可选
表示要拦截的url，可以使字符串，也可以是正则

2、rtype 可选
表示要拦截的ajax请求方式，如get、post

3、template 可选
数据模板，可以是对象也可以是字符串

4、function(option) 可选
表示用于生成响应数据的函数
*/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//main.js</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">'development'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;../mock/mock.js&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">//mock.js</span>
<span class="token keyword">import</span> Mock <span class="token keyword">from</span> <span class="token string">&quot;mockjs&quot;</span>

<span class="token keyword">const</span> mocks <span class="token operator">=</span> require<span class="token punctuation">.</span><span class="token function">context</span><span class="token punctuation">(</span><span class="token string">&quot;@/views&quot;</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">.+\/mock\/.*\.js</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
mocks<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">mockPath</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> mock <span class="token operator">=</span> <span class="token function">mocks</span><span class="token punctuation">(</span>mockPath<span class="token punctuation">)</span><span class="token punctuation">.</span>default
    Mock<span class="token punctuation">.</span><span class="token function">mock</span><span class="token punctuation">(</span>mock<span class="token punctuation">.</span>url<span class="token punctuation">,</span> mock<span class="token punctuation">.</span>method<span class="token punctuation">,</span> mock<span class="token punctuation">.</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// @/views/../mock/index.js</span>
<span class="token keyword">const</span> listData <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        <span class="token literal-property property">date</span><span class="token operator">:</span> <span class="token string">&quot;2016-05-02&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;王小虎&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">address</span><span class="token operator">:</span> <span class="token string">&quot;上海市普陀区金沙江路 1518 弄&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        <span class="token literal-property property">date</span><span class="token operator">:</span> <span class="token string">&quot;2016-05-04&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;王小虎&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">address</span><span class="token operator">:</span> <span class="token string">&quot;上海市普陀区金沙江路 1517 弄&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        <span class="token literal-property property">date</span><span class="token operator">:</span> <span class="token string">&quot;2016-05-01&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;王小虎&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">address</span><span class="token operator">:</span> <span class="token string">&quot;上海市普陀区金沙江路 1519 弄&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span>
        <span class="token literal-property property">date</span><span class="token operator">:</span> <span class="token string">&quot;2016-05-03&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;王小虎&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">address</span><span class="token operator">:</span> <span class="token string">&quot;上海市普陀区金沙江路 1516 弄号&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">'/user/info'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">'get'</span><span class="token punctuation">,</span>
    <span class="token function-variable function">result</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">code</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token literal-property property">info</span><span class="token operator">:</span> listData
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br></div></div><h4 id="_2、后端mock"><a href="#_2、后端mock" class="header-anchor">#</a> 2、后端mock</h4> <ul><li>可对接第三方mock服务</li> <li>使用devserver的before进行数据mock：<code>before</code> 和 <code>after</code> 配置用于在 webpack-dev-server 定义额外的中间件
<ul><li><code>before</code> 在 webpack-dev-server 静态资源中间件处理之前，可以用于拦截部分请求返回特定内容，或者实现简单的数据 mock</li> <li><code>after</code> 在 webpack-dev-server 静态资源中间件处理之后，比较少用到，可以用于打印日志或者做一些额外处理</li> <li>before和after参数：<code>function (app, server, compiler)</code></li></ul></li></ul> <p>思路：</p> <ol><li>webpack-dev-server本质是一个express服务器，使用原生before勾子注册路径实现数据mock，使用chokidar进行数据检测实现热更新加载。</li> <li>before勾子中使用webpack-api-mocker中间件实现数据mock和热更新。</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">/*
apiMocker(app, mockerFilePath[, options])
apiMocker(app, Mocker[, options])
*/</span>

<span class="token comment">//vue.config.js</span>
<span class="token function-variable function">before</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">app</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">apiMocker</span><span class="token punctuation">(</span>app<span class="token punctuation">,</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'./mock/mock-server.js'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">//mock-server.js</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
		<span class="token string-property property">'GET /api/login'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">success</span><span class="token operator">:</span> appData<span class="token punctuation">.</span>login<span class="token punctuation">.</span>success<span class="token punctuation">,</span>
        <span class="token literal-property property">message</span><span class="token operator">:</span> appData<span class="token punctuation">.</span>login<span class="token punctuation">.</span>message
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string-property property">'GET /api/list'</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
            <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            <span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token string">'kenny'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">sex</span><span class="token operator">:</span> <span class="token number">6</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
            <span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token string">'kenny'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">sex</span><span class="token operator">:</span> <span class="token number">6</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token string-property property">'POST /api/post'</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token string">'error'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">code</span><span class="token operator">:</span> <span class="token number">403</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token string-property property">'DELETE /api/remove'</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token literal-property property">status</span><span class="token operator">:</span> <span class="token string">'ok'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">'删除成功！'</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">11/10/2021, 8:09:16 PM</span></div></footer> <!----> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.9e441e61.js" defer></script><script src="/assets/js/2.36bde0fd.js" defer></script><script src="/assets/js/76.451d3bf2.js" defer></script><script src="/assets/js/3.5a07e503.js" defer></script>
  </body>
</html>